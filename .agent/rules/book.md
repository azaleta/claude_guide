---
trigger: always_on
---

```md
# Antigravity Workspace Rules: Book Authoring

## 0. Scope
本规则用于约束在本 workspace/project 中生成与维护一本中文专业书籍的所有产出（SUMMARY.md、章节与小节 Markdown、插图、链接等）。

---

## 1. 核心规范（规模与结构）

### MUST
- 全书规模必须满足：
  - 3-4部分（Part），共9-16章（Chapter）。
  - 每一部分包含3-4章。
  - 每一章包含3-6小节（Section）。
  - 每一章必须包含“本章小结”。
  - 附录也按“一章”对待，但附录不包含本章小结。
- 必须使用 SUMMARY.md 管理书籍脉络与目录，整体结构必须符合“从入门到精通”的学习路径。
- 除“本章小结”外，各内容小节的正文文字内容建议在800-2000字范围内；明显偏离必须回收精炼或补足关键解释，禁止用空话凑字数。
- 每一章必须有一个本章小结（summary.md），小结要求：回顾本章要点、给出关键概念清单、指出常见误区与实践建议，长度控制在“足以覆盖要点但不扩写”。

### MUST NOT
- 不得输出与本书主题无关的泛化内容。
- 不得将附录当作无结构杂项堆砌；附录仍需章节化组织。

---

## 2. 目录结构、文件命名与层级

### MUST
- 文件与目录命名必须使用“序号+短名”格式：
  - 章文件夹：`01_intro`、`02_foundations` 等（两位序号 + 下划线 + 短名）。
  - 小节文件：`1.1_born.md`、`2.3_pipeline.md` 等（章.节 + 下划线 + 短名）。
  - 每章本章小结文件名固定为：`summary.md`（放在该章目录下）。
  - 附录章节目录同样遵循“序号+短名”，但目录内不创建 `summary.md`。
- 标题层级必须严格一致：
  - 章标题为1级：`# 第一章：章标题`
  - 小节标题为2级：`## 1.1 小节标题`（包括本章小结）
  - 小节正文从3级标题开始。
- 编号规则：
  - 1-3级标题必须带编号。
  - 4级及以上标题禁止带编号。
- 所有标题不得包含带括号的英文说明（标题中不出现“(xxx)”或“（xxx）”形式的英文解释）。

### MUST NOT
- 不得出现无编号的章/节文件。
- 不得在章节目录之外存放该章节的本地图片文件。

---

## 3. 语言与风格

### MUST
- 全中文创作。
- 风格要求：专业、简练、严谨、通顺；深入浅出，便于理解。
- 对难点知识点必须通过“举例”或“图示（优先mermaid）”辅助解释；例子必须服务于概念澄清。
- 过渡语句以结构推进为主，保持简明，避免段落空转。

### MUST NOT
- 避免废话与口语化套话；尽量少用“你我”等主观代词与对话腔表达。
- 禁止营销式措辞、情绪化表述、夸张结论。
- 禁止在术语未定义时堆叠术语或用黑箱表述替代解释。

---

## 4. 内容质量、事实准确与时效性

### MUST
- 必须检索并整合最新且最核心的专业知识，尤其是：
  - 相关项目官方文档（优先）。
  - 标准规范/官方发布材料。
  - 综述论文与高质量学术资料（用于全局脉络与关键结论）。
- 对容易过时的信息（版本、API、默认配置、限制条件、配额、政策、价格、行为差异）必须先检索核验，以最新权威来源为准。
- 核心关键内容必须详细讲解：
  - 定义、背景/动机、适用场景、边界条件、常见错误、最佳实践、必要示例（可用伪代码/流程图/对比表）。
- 过渡性内容保持短句与结构化要点，不展开无关细节。

### MUST NOT
- 禁止编造或猜测：来源、论文、发布日期、版本行为、API细节、实验结论。
- 禁止用“常识”替代需要核验的关键事实。
- 若无法核验某事实，必须改写为不依赖该事实的表达，或明确标注为“待核验项”并避免作为推理前提。

---

## 5. 引用链接

### MUST
- 可适当加入相关超链接，格式必须为：`[文本](url)`。
- 链接必须与上下文强相关，用于指向权威资料或关键补充。

### MUST NOT
- 禁止堆砌链接或加入与内容弱相关链接。

---

## 6. 图片与图示（含 mermaid 严格规范）

### MUST
- 在适当位置插入示意图（流程图/架构图/对比图等）并给出简要解释（图表达什么、如何读、对应正文哪一部分）。
- 图片/图示要求：清晰简约、比例适当、不超过页宽。
- 图示优先使用 mermaid，其次可使用外部工具生成（如 draw.io），再其次可使用本地图片。
- 若使用本地图片：
  - 每章图片必须放在该章目录下的 `_images/` 子目录。
  - 图片格式优先 png/jpg/webp。
  - 引用语法必须为：`![描述](image_path)`。

### Mermaid Strict Rules（必须逐条满足）
- 节点 ID：只能是简短标识符（字母/数字/下划线），例如 `node_a`、`step1`。
- 节点 label：全部用双引号包起来。
- subgraph 标题：必须用双引号包起来。
- 显示文本：必须放在 `[]` / `()` / `{}` 内。
- 凡是包含空格、冒号、中文的文本，必须只出现在显示文本中；不得出现在节点 ID 或其它非显示位置。

---

## 7. 交付自检（每次生成/修改后必须执行并输出结果）

### MUST
在输出任何章节内容、目录改动或大段新增前，必须完成以下自检，并在输出末尾以清单形式给出“通过/不通过 + 原因 + 修正动作”（若已修正则说明修正点）：

1) 结构自检
- SUMMARY.md 是否覆盖全书3-4部分、9-16章。
- 每部分是否3-4章；每章是否3-6小节；每章是否含 `summary.md`；附录是否无 `summary.md`。
- 命名是否严格符合“序号+短名”。

2) 标题自检
- 章为#，节为##，正文从###开始。
- 1-3级标题是否带编号；4级及以上是否无编号；标题是否无括号英文说明。

3) 内容自检
- 非本章小结小节是否大致在800-2000字区间（偏离需说明与调整）。
- 行文是否专业简练、无废话与对话腔；难点是否有例子或图示。

4) 时效与准确性自检
- 关键事实是否已检索核验并来自权威来源；是否避免无依据陈述。

5) 链接与图片自检
- 超链接格式与相关性是否正确。
- mermaid 是否满足全部严格规范。
- 本地图片是否位于章节目录 `_images/` 且引用语法正确。
```